# MoodReads Recommendation System

This tool matches books to users based on their emotional preferences and mood queries. It leverages the enhanced emotional profiles generated by the emotional analysis system to provide personalized book recommendations.

## Features

- **Mood Query Analysis**:
  - Extracts current emotional state from user queries
  - Identifies desired emotional experiences
  - Detects emotional journey/arc preferences
  - Determines intensity preferences
  - Extracts emotional keywords

- **Multidimensional Matching**:
  - Matches based on primary emotions
  - Considers emotional keywords overlap
  - Compares emotional arcs/journeys
  - Calculates weighted composite scores
  - Provides detailed explanations for recommendations

- **Recommendation Output**:
  - Ranked list of book recommendations
  - Similarity scores for different emotional dimensions
  - Personalized explanations for each recommendation
  - Option to save recommendations to JSON

## Requirements

- Python 3.6+
- Anthropic API key (Claude AI)
- Enhanced book emotional profiles
- Dependencies listed in `requirements.txt`

## Installation

1. Ensure you have Python installed
2. Install the required dependencies:

```bash
pip install -r requirements.txt
```

3. Set up your Anthropic API key:
   - Create a `.env` file in the project directory
   - Add your API key: `ANTHROPIC_API_KEY=your_api_key_here`
   - Or set it as an environment variable: `export ANTHROPIC_API_KEY=your_api_key_here`

4. Create a directory for enhanced book profiles:

```bash
mkdir enhanced_books
```

5. Add enhanced book review JSON files to the `enhanced_books` directory (output from the `emotional_analysis.py` script)

## Usage

Basic usage:

```bash
python mood_recommendation.py --query "I'm feeling stressed and overwhelmed. I'd like a book that will help me feel calm and peaceful, with a journey from anxiety to tranquility."
```

This will:
- Analyze the user's mood query
- Load all book emotional profiles from the `enhanced_books` directory
- Match books to the user's mood preferences
- Display the top 5 recommendations with explanations

### Command Line Arguments

- `--query`: User mood query (required)
- `--books-dir`: Directory containing enhanced book reviews (default: `enhanced_books`)
- `--top-n`: Number of top matches to return (default: 5)
- `--output`: Output JSON file for recommendations (optional)

Example with custom options:

```bash
python mood_recommendation.py --query "I want a thrilling book that starts with mystery, builds tension in the middle, and ends with satisfaction" --books-dir my_books --top-n 10 --output recommendations.json
```

## Example Mood Queries

Here are some example mood queries you can try:

1. "I'm feeling down and need something uplifting that will make me laugh and feel hopeful."

2. "I'm in the mood for an emotional rollercoaster - something that starts with curiosity, builds to intense emotions in the middle, and ends with a sense of satisfaction."

3. "I'm feeling stressed and anxious. I'd like a book that's calming and peaceful, with a gentle emotional journey."

4. "I want something intellectually stimulating that will make me think deeply and feel a sense of wonder."

5. "I'm looking for a book that evokes nostalgia and reflection, with a bittersweet quality."

## How It Works

### 1. Mood Query Analysis

The system uses Claude AI to analyze the user's mood query and extract:
- Current emotional state
- Desired emotional experience
- Emotional journey preferences
- Intensity preferences
- Emotional keywords

### 2. Book Matching

For each book in the database, the system calculates:
- Emotion similarity: How well the book's primary emotions match the user's desired emotions
- Keyword similarity: Overlap between user emotional keywords and book emotional keywords
- Arc similarity: How well the book's emotional arc matches the user's desired journey

These scores are combined into a weighted composite score:
- Emotions: 50% weight
- Keywords: 30% weight
- Arc: 20% weight

### 3. Explanation Generation

For each recommended book, the system generates a personalized explanation highlighting:
- Matching emotions
- Matching keywords
- Matching emotional arc elements
- Overall emotional profile

## Integration with MoodReads

This recommendation system is designed to work with the MoodReads platform:

1. The `extract_goodreads_reviews.py` script extracts reviews from Goodreads
2. The `emotional_analysis.py` script enhances reviews with emotional analysis
3. The `mood_recommendation.py` script matches books to user mood queries

Together, these components create a comprehensive mood-based recommendation system that can help users find books that match their emotional preferences.

## Performance Considerations

- API calls to Claude can be expensive and time-consuming
- Consider caching user mood analysis results for similar queries
- For production use, implement a database for storing book emotional profiles
- Consider batch processing for analyzing large numbers of user queries

## Troubleshooting

- **API Key Issues**: Ensure your Anthropic API key is correctly set in the `.env` file or as an environment variable
- **No Book Profiles**: Make sure you have added enhanced book review JSON files to the books directory
- **JSON Parsing Errors**: If Claude's response can't be parsed as JSON, the script will save the raw response

## License

This project is open source under the MIT License. 